# containerlab parameters
# name of the containerlab
name: ceostopo1

mgmt:
  network: custom_mgmt
  ipv4_subnet: 192.168.123.0/24

topology:
  kinds:
    ceos:
      startup-config: templates/ceos-cfg.j2
      image: ceos-lab:4.28.2F
      publish:
        - https
    linux:
      image: alpine-host

  nodes:
    spine1:
      kind: ceos
      mgmt_ipv4: 192.168.123.11
      binds:
        - templates/spine1:/mnt/flash/ceos-config:ro
        - templates/32C:/mnt/flash/EosIntfMapping.json:ro
      group: spine
    spine2:
      kind: ceos
      mgmt_ipv4: 192.168.123.12
      binds:
        - templates/spine2:/mnt/flash/ceos-config:ro
        - templates/32C:/mnt/flash/EosIntfMapping.json:ro
      group: spine
    leaf1:
      kind: ceos
      mgmt_ipv4: 192.168.123.21
      binds:
        - templates/leaf1:/mnt/flash/ceos-config:ro
        - templates/48C8:/mnt/flash/EosIntfMapping.json:ro
      group: leaf
    leaf2:
      kind: ceos
      mgmt_ipv4: 192.168.123.22
      binds:
        - templates/leaf2:/mnt/flash/ceos-config:ro
        - templates/48C8:/mnt/flash/EosIntfMapping.json:ro
      group: leaf
    leaf3:
      kind: ceos
      mgmt_ipv4: 192.168.123.23
      binds:
        - templates/leaf3:/mnt/flash/ceos-config:ro
        - templates/48C8:/mnt/flash/EosIntfMapping.json:ro
      group: leaf  
    leaf4:
      kind: ceos
      mgmt_ipv4: 192.168.123.24
      binds:
        - templates/leaf4:/mnt/flash/ceos-config:ro
        - templates/48C8:/mnt/flash/EosIntfMapping.json:ro
      group: leaf  
    host1:
      kind: linux
      mgmt_ipv4: 192.168.123.31
      env:
        TMODE: lacp      
      group: server
    host2:
      kind: linux
      mgmt_ipv4: 192.168.123.32
      env:
        TMODE: lacp
      group: server

  links:
    # Fabric links
    - endpoints: [ "leaf1:eth49_1", "spine1:eth1_1" ]
    - endpoints: [ "leaf1:eth50_1", "spine2:eth1_1" ]
    - endpoints: [ "leaf2:eth49_1", "spine1:eth2_1" ]
    - endpoints: [ "leaf2:eth50_1", "spine2:eth2_1" ]
    - endpoints: [ "leaf3:eth49_1", "spine1:eth3_1" ]
    - endpoints: [ "leaf3:eth50_1", "spine2:eth3_1" ]
    - endpoints: [ "leaf4:eth49_1", "spine1:eth4_1" ]
    - endpoints: [ "leaf4:eth50_1", "spine2:eth4_1" ]
    # MLAG links
    - endpoints: [ "leaf1:eth53_1", "leaf2:eth53_1" ]
    - endpoints: [ "leaf1:eth54_1", "leaf2:eth54_1" ]
    - endpoints: [ "leaf3:eth53_1", "leaf4:eth53_1" ]
    - endpoints: [ "leaf3:eth54_1", "leaf4:eth54_1" ]
    # Server links
    - endpoints: [ "leaf1:eth1", "host1:eth1" ]
    - endpoints: [ "leaf2:eth1", "host1:eth2" ]
    - endpoints: [ "leaf3:eth1", "host2:eth1" ]
    - endpoints: [ "leaf4:eth1", "host2:eth2" ]